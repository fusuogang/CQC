<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<meta name="baidu-tc-verification" content="0fb041a64ee71333c957d8c784961cc8" />
<meta property="qc:admins" content="145637425211673116375" />
<meta http-equiv="X-UA-Compatible" content="IE=10,IE=9,IE=8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<title>PHP高级特性四之SMTP邮件发送 | 静觅</title>
<script>
window._deel = {name: '静觅',url: 'http://cuiqingcai.com/wp-content/themes/Yusi', ajaxpager: 'on', commenton: 1, roll: [0,0]}
</script>

<!-- All in One SEO Pack 2.2.6.2 by Michael Torbert of Semper Fi Web Design[392,427] -->
<meta name="description" itemprop="description" content="综述 PHP的邮件发送最常见的便是SMTP，通过编写一个Smtp类，设置好smtp服务器，邮箱用户名，密码，即可实现邮件的发送 邮件发送 邮件发送的类如下，文件名叫做 然后便是一个php文件引用该文件，设置好各种参数 最后是一个表单提交，包括目的邮箱，主题，内容 代码下载 代码下载" />

<meta name="keywords" itemprop="keywords" content="php" />

<!-- /all in one seo pack -->
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/cuiqingcai.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.2.2"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='crayon-css'  href='http://cuiqingcai.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=2.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-github-css'  href='http://cuiqingcai.com/wp-content/plugins/crayon-syntax-highlighter/themes/github/github.css?ver=2.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='http://cuiqingcai.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=2.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='page-list-style-css'  href='http://cuiqingcai.com/wp-content/plugins/sitemap/css/page-list.css?ver=4.3' type='text/css' media='all' />
<link rel='stylesheet' id='style-css'  href='http://cuiqingcai.com/wp-content/themes/Yusi/style.css?ver=33' type='text/css' media='all' />
<script type="text/javascript">
var duoshuoQuery = {"short_name":"cuiqingcai","sso":{"login":"http:\/\/cuiqingcai.com\/wp-login.php?action=duoshuo_login","logout":"http:\/\/cuiqingcai.com\/wp-login.php?action=logout&_wpnonce=55b45d9a99"},"theme":"default","stylePatch":"wordpress\/\u9759\u89c5"};
duoshuoQuery.sso.login += '&redirect_to=' + encodeURIComponent(window.location.href);
duoshuoQuery.sso.logout += '&redirect_to=' + encodeURIComponent(window.location.href);
</script>
<script type="text/javascript" src="http://static.duoshuo.com/embed.js" charset="UTF-8" async="async"></script>
<script type='text/javascript' src='//libs.baidu.com/jquery/1.8.3/jquery.min.js?ver=1.0'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.7.1","is_admin":"0","ajaxurl":"http:\/\/cuiqingcai.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"\u4f7f\u7528 %s \u590d\u5236\uff0c\u4f7f\u7528 %s \u7c98\u8d34\u3002","minimize":"\u70b9\u51fb\u5c55\u5f00\u4ee3\u7801"};
/* ]]> */
</script>
<script type='text/javascript' src='http://cuiqingcai.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=2.7.1'></script>
<script type='text/javascript' src='http://cuiqingcai.com/wp-content/themes/Yusi/js/jquery.fitvids.js?ver=2.0.110526'></script>
<link rel='prev' title='JavaScript高级用法五之常用对象' href='http://cuiqingcai.com/1444.html' />
<link rel='next' title='PHP高级特性五之时间处理' href='http://cuiqingcai.com/1473.html' />
<link rel='canonical' href='http://cuiqingcai.com/1470.html' />
<link rel='shortlink' href='http://cuiqingcai.com/?p=1470' />
<meta name="keywords" content="PHP, PHP">
<meta name="description" content="综述 PHP的邮件发送最常见的便是SMTP，通过编写一个Smtp类，设置好smtp服务器，邮箱用户名，密码，即可实现邮件的发送 邮件发送 邮件发送的类如下，文件名叫做 [crayon-562afcc56784c534343845/] [crayon-562afcc56785c712848215/] 然后便是一个php文件引用该文件，设置好各种参数 [crayon-562afcc56786b263738218/] 最后是一个表单提交，包括">
        <script type="text/javascript">
            jQuery(document).ready( function() {
                jQuery('.video').fitVids();
            });
        </script><!--[if lt IE 9]><script src="http://cuiqingcai.com/wp-content/themes/Yusi/js/html5.js"></script><![endif]-->

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?3ef185224776ec2561c9f7066ead4f24";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<meta name="360-site-verification" content="bdc579accc68a98f1258ebcce2266afa" />
<script type="text/javascript" name="baidu-tc-cerfication" data-appid="5411405" src="http://apps.bdimg.com/cloudaapi/lightapp.js"></script>
<link rel="shortcut icon" type="image/x-icon" href="http://cuiqingcai.com/fav.png" />
<script type="text/javascript">
$(document).ready(function(){
	var imgs = new Array();
	imgs[0] = 'http://qiniu.cuiqingcai.com/wp-content/uploads/2015/05/20150525111154.jpg';
	imgs[1] = 'http://qiniu.cuiqingcai.com/wp-content/uploads/2015/05/20150525111447.jpg';
	imgs[2] = 'http://qiniu.cuiqingcai.com/wp-content/uploads/2015/05/20150525112058.jpg';
	imgs[3] = 'http://qiniu.cuiqingcai.com/wp-content/uploads/2015/05/20150525112112.jpg';
	imgs[4] = 'http://qiniu.cuiqingcai.com/wp-content/uploads/2015/05/20150525112129.jpg';
	imgs[5] = 'http://qiniu.cuiqingcai.com/wp-content/uploads/2015/05/20150525112155.jpg';
	$('.ds-avatar img[src*="cdncache"]').each(function(){
		var rand = Math.floor(Math.random()*imgs.length);
		$(this).attr("src",imgs[rand]);
	})
});
</script>
</head>
<body class="single single-post postid-1470 single-format-standard">

<header id="header" class="header">
<div class="container-inner">
 <div class="yusi-logo">
                    <a href="/">
                        <h1>
                                                        <span class="yusi-mono">静觅</span>
                                                        <span class="yusi-bloger">静静寻觅生活的美好</span>
                                                    </h1>
                    </a>
    </div>
</div>

	<div id="nav-header" class="navbar">
		
		<ul class="nav">
			<li id="menu-item-44" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-44"><a href="http://cuiqingcai.com">首页</a></li>
<li id="menu-item-14" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-14"><a href="http://cuiqingcai.com/category/life">生活笔记</a>
<ul class="sub-menu">
	<li id="menu-item-19" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-19"><a href="http://cuiqingcai.com/category/life/notes">个人随笔</a></li>
	<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-18"><a href="http://cuiqingcai.com/category/life/daily">个人日记</a></li>
	<li id="menu-item-15" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-15"><a href="http://cuiqingcai.com/category/life/presatation">个人展示</a></li>
</ul>
</li>
<li id="menu-item-7" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-7"><a href="http://cuiqingcai.com/category/technique">技术杂谈</a>
<ul class="sub-menu">
	<li id="menu-item-9" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9"><a href="http://cuiqingcai.com/category/technique/cc">C/C++</a></li>
	<li id="menu-item-11" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-11"><a href="http://cuiqingcai.com/category/technique/java">Java</a></li>
	<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-17"><a href="http://cuiqingcai.com/category/technique/php">PHP</a></li>
	<li id="menu-item-153" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-153"><a href="http://cuiqingcai.com/category/technique/html">HTML</a></li>
	<li id="menu-item-960" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-960"><a href="http://cuiqingcai.com/category/technique/python">Python</a></li>
	<li id="menu-item-1277" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1277"><a href="http://cuiqingcai.com/category/technique/javascript">JS</a></li>
	<li id="menu-item-16" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="http://cuiqingcai.com/category/technique/other">Other</a></li>
</ul>
</li>
<li id="menu-item-418" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-418"><a href="http://cuiqingcai.com/category/resources">福利专区</a></li>
<li id="menu-item-851" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-851"><a href="http://cuiqingcai.com/about">关于自己</a></li>
<li id="menu-item-251" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-251"><a href="http://cuiqingcai.com/contact">给我留言</a></li>
<li id="menu-item-1131" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1131"><a href="http://cuiqingcai.com/donate">赞助作者</a></li>
<li style="float:right;">
                    <div class="toggle-search"><i class="fa fa-search"></i></div>
<div class="search-expand" style="display: none;"><div class="search-expand-inner"><form method="get" class="searchform themeform" onsubmit="location.href='http://cuiqingcai.com/?s=' + encodeURIComponent(this.s.value).replace(/%20/g, '+'); return false;" action="/"><div> <input type="ext" class="search" name="s" onblur="if(this.value=='')this.value='search...';" onfocus="if(this.value=='search...')this.value='';" value="search..."></div></form></div></div>
</li>
		</ul>
	</div>
	</div>
</header>
<section class="container"><div class="speedbar">
					<div class="pull-right">
				<i class="fa fa-user"></i> <a href="/wp-login.php?action=register">投稿</a>&nbsp;&nbsp;&nbsp;   <i class="fa fa-power-off"></i> <a href="http://cuiqingcai.com/wp-login.php">登录</a>			</div>
				<div class="toptip"><strong class="text-success"><i class="fa fa-volume-up"></i> </strong>    欢迎来到我的博客，浏览文章时点击一下广告是您对我最大的支持，谢谢啦！</div>
	</div>
	<div class="content-wrap">
	<div class="content">
<div class="breadcrumbs"><a title="返回首页" href="http://cuiqingcai.com"><i class="fa fa-home"></i></a> <small>></small> <a href="http://cuiqingcai.com/category/technique">技术杂谈</a> <small>></small> <a href="http://cuiqingcai.com/category/technique/php">PHP</a> <small>></small> <span class="muted">PHP高级特性四之SMTP邮件发送</span></div>
				<header class="article-header">
			<h1 class="article-title"><a href="http://cuiqingcai.com/1470.html">PHP高级特性四之SMTP邮件发送</a></h1>
			<div class="meta">
				<span id="mute-category" class="muted"><i class="fa fa-list-alt"></i><a href="http://cuiqingcai.com/category/technique/php"> PHP</a></span>				<span class="muted"><i class="fa fa-user"></i> <a href="http://cuiqingcai.com/author/cqcre">崔庆才</a></span>
				<time class="muted"><i class="fa fa-clock-o"></i> 7个月前 (03-18)</time>
				<span class="muted"><i class="fa fa-eye"></i> 537℃</span>
				<span class="muted"><i class="fa fa-comments-o"></i> <a href="http://cuiqingcai.com/1470.html#comments">2评论</a></span>							</div>
		</header>
<div class="banner banner-post"><!-- tuici -->
<script type="text/javascript">
    /* 创建于 2015-02-23*/
var cpro_id = "u1959022";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/cnw.js" type="text/javascript"></script>
<!-- biaoqian -->
<script type="text/javascript">
    /*860*60 创建于 2015-02-25*/
    var cpro_id = "u1959939";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>

</div>		<article class="article-content">
			<h2>综述</h2>
<p>PHP的邮件发送最常见的便是SMTP，通过编写一个Smtp类，设置好smtp服务器，邮箱用户名，密码，即可实现邮件的发送</p>
<h2>邮件发送</h2>
<p>邮件发送的类如下，文件名叫做</p><!-- Crayon Syntax Highlighter v2.7.1 -->

		<div id="crayon-562afcc56784c534343845" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; float: left; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
email.class.php</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-562afcc56784c534343845-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-562afcc56784c534343845-1"><span class="crayon-v">email</span><span class="crayon-sy">.</span><span class="crayon-t">class</span><span class="crayon-sy">.</span><span class="crayon-v">php</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v2.7.1 -->

		<div id="crayon-562afcc56785c712848215" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; float: left; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="含多种语言"></span><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;?php

/* smtp class */
class smtp {
    /* Public Variables */
    var $smtp_port;
    var $time_out;
    var $host_name;
    var $log_file;
    var $relay_host;
    var $debug;
    var $auth;
    var $user;
    var $pass;
    /* Private Variables */
    var $sock;
    /* Constractor */
    function smtp($relay_host = "", $smtp_port = 25, $auth = false, $user, $pass) {
        $this-&gt;debug = FALSE;
        $this-&gt;smtp_port = $smtp_port;
        $this-&gt;relay_host = $relay_host;
        $this-&gt;time_out = 30; //is used in fsockopen()
        //
        $this-&gt;auth = $auth; //auth
        $this-&gt;user = $user;
        $this-&gt;pass = $pass;
        //
        $this-&gt;host_name = "localhost"; //is used in HELO command
        $this-&gt;log_file = "";
        $this-&gt;sock = FALSE;
    }
    /* Main Function */
    function sendmail($to, $from, $subject = "", $body = "", $mailtype, $cc = "", $bcc = "", $additional_headers = "") {
        $mail_from = $this-&gt;get_address($this-&gt;strip_comment($from));
        $body = preg_replace("/(^|(\r\n))(\.)/", "\1.\3", $body);
        $header = "MIME-Version:1.0\r\n";
        if ($mailtype == "HTML") {
            $header.= "Content-Type:text/html\r\n";
        }
        $header.= "To: " . $to . "\r\n";
        if ($cc != "") {
            $header.= "Cc: " . $cc . "\r\n";
        }
        $header.= "From: $from&lt;" . $from . "&gt;\r\n";
        $header.= "Subject: " . $subject . "\r\n";
        $header.= $additional_headers;
        $header.= "Date: " . date("r") . "\r\n";
        $header.= "X-Mailer:By Redhat (PHP/" . phpversion() . ")\r\n";
        list($msec, $sec) = explode(" ", microtime());
        $header.= "Message-ID: &lt;" . date("YmdHis", $sec) . "." . ($msec * 1000000) . "." . $mail_from . "&gt;\r\n";
        $TO = explode(",", $this-&gt;strip_comment($to));
        if ($cc != "") {
            $TO = array_merge($TO, explode(",", $this-&gt;strip_comment($cc)));
        }
        if ($bcc != "") {
            $TO = array_merge($TO, explode(",", $this-&gt;strip_comment($bcc)));
        }
        $sent = TRUE;
        foreach ($TO as $rcpt_to) {
            $rcpt_to = $this-&gt;get_address($rcpt_to);
            if (!$this-&gt;smtp_sockopen($rcpt_to)) {
                $this-&gt;log_write("Error: Cannot send email to " . $rcpt_to . "\n");
                $sent = FALSE;
                continue;
            }
            if ($this-&gt;smtp_send($this-&gt;host_name, $mail_from, $rcpt_to, $header, $body)) {
                $this-&gt;log_write("E-mail has been sent to &lt;" . $rcpt_to . "&gt;\n");
            } else {
                $this-&gt;log_write("Error: Cannot send email to &lt;" . $rcpt_to . "&gt;\n");
                $sent = FALSE;
            }
            fclose($this-&gt;sock);
            $this-&gt;log_write("Disconnected from remote host\n");
        }
        return $sent;
    }
    /* Private Functions */
    function smtp_send($helo, $from, $to, $header, $body = "") {
        if (!$this-&gt;smtp_putcmd("HELO", $helo)) {
            return $this-&gt;smtp_error("sending HELO command");
        }
        //auth
        if ($this-&gt;auth) {
            if (!$this-&gt;smtp_putcmd("AUTH LOGIN", base64_encode($this-&gt;user))) {
                return $this-&gt;smtp_error("sending HELO command");
            }
            if (!$this-&gt;smtp_putcmd("", base64_encode($this-&gt;pass))) {
                return $this-&gt;smtp_error("sending HELO command");
            }
        }
        //
        if (!$this-&gt;smtp_putcmd("MAIL", "FROM:&lt;" . $from . "&gt;")) {
            return $this-&gt;smtp_error("sending MAIL FROM command");
        }
        if (!$this-&gt;smtp_putcmd("RCPT", "TO:&lt;" . $to . "&gt;")) {
            return $this-&gt;smtp_error("sending RCPT TO command");
        }
        if (!$this-&gt;smtp_putcmd("DATA")) {
            return $this-&gt;smtp_error("sending DATA command");
        }
        if (!$this-&gt;smtp_message($header, $body)) {
            return $this-&gt;smtp_error("sending message");
        }
        if (!$this-&gt;smtp_eom()) {
            return $this-&gt;smtp_error("sending &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt; [EOM]");
        }
        if (!$this-&gt;smtp_putcmd("QUIT")) {
            return $this-&gt;smtp_error("sending QUIT command");
        }
        return TRUE;
    }
    function smtp_sockopen($address) {
        if ($this-&gt;relay_host == "") {
            return $this-&gt;smtp_sockopen_mx($address);
        } else {
            return $this-&gt;smtp_sockopen_relay();
        }
    }
    function smtp_sockopen_relay() {
        $this-&gt;log_write("Trying to " . $this-&gt;relay_host . ":" . $this-&gt;smtp_port . "\n");
        $this-&gt;sock = @fsockopen($this-&gt;relay_host, $this-&gt;smtp_port, $errno, $errstr, $this-&gt;time_out);
        if (!($this-&gt;sock &amp;&amp; $this-&gt;smtp_ok())) {
            $this-&gt;log_write("Error: Cannot connenct to relay host " . $this-&gt;relay_host . "\n");
            $this-&gt;log_write("Error: " . $errstr . " (" . $errno . ")\n");
            return FALSE;
        }
        $this-&gt;log_write("Connected to relay host " . $this-&gt;relay_host . "\n");
        return TRUE;;
    }
    function smtp_sockopen_mx($address) {
        $domain = preg_replace("/^.+@([^@]+)$/", "\1", $address);
        if (!@getmxrr($domain, $MXHOSTS)) {
            $this-&gt;log_write("Error: Cannot resolve MX \"" . $domain . "\"\n");
            return FALSE;
        }
        foreach ($MXHOSTS as $host) {
            $this-&gt;log_write("Trying to " . $host . ":" . $this-&gt;smtp_port . "\n");
            $this-&gt;sock = @fsockopen($host, $this-&gt;smtp_port, $errno, $errstr, $this-&gt;time_out);
            if (!($this-&gt;sock &amp;&amp; $this-&gt;smtp_ok())) {
                $this-&gt;log_write("Warning: Cannot connect to mx host " . $host . "\n");
                $this-&gt;log_write("Error: " . $errstr . " (" . $errno . ")\n");
                continue;
            }
            $this-&gt;log_write("Connected to mx host " . $host . "\n");
            return TRUE;
        }
        $this-&gt;log_write("Error: Cannot connect to any mx hosts (" . implode(", ", $MXHOSTS) . ")\n");
        return FALSE;
    }
    function smtp_message($header, $body) {
        fputs($this-&gt;sock, $header . "\r\n" . $body);
        $this-&gt;smtp_debug("&gt; " . str_replace("\r\n", "\n" . "&gt; ", $header . "\n&gt; " . $body . "\n&gt; "));
        return TRUE;
    }
    function smtp_eom() {
        fputs($this-&gt;sock, "\r\n.\r\n");
        $this-&gt;smtp_debug(". [EOM]\n");
        return $this-&gt;smtp_ok();
    }
    function smtp_ok() {
        $response = str_replace("\r\n", "", fgets($this-&gt;sock, 512));
        $this-&gt;smtp_debug($response . "\n");
        if (!preg_match("/^[23]/", $response)) {
            fputs($this-&gt;sock, "QUIT\r\n");
            fgets($this-&gt;sock, 512);
            $this-&gt;log_write("Error: Remote host returned \"" . $response . "\"\n");
            return FALSE;
        }
        return TRUE;
    }
    function smtp_putcmd($cmd, $arg = "") {
        if ($arg != "") {
            if ($cmd == "") $cmd = $arg;
            else $cmd = $cmd . " " . $arg;
        }
        fputs($this-&gt;sock, $cmd . "\r\n");
        $this-&gt;smtp_debug("&gt; " . $cmd . "\n");
        return $this-&gt;smtp_ok();
    }
    function smtp_error($string) {
        $this-&gt;log_write("Error: Error occurred while " . $string . ".\n");
        return FALSE;
    }
    function log_write($message) {
        $this-&gt;smtp_debug($message);
        if ($this-&gt;log_file == "") {
            return TRUE;
        }
        $message = date("M d H:i:s ") . get_current_user() . "[" . getmypid() . "]: " . $message;
        if (!@file_exists($this-&gt;log_file) || !($fp = @fopen($this-&gt;log_file, "a"))) {
            $this-&gt;smtp_debug("Warning: Cannot open log file \"" . $this-&gt;log_file . "\"\n");
            return FALSE;;
        }
        flock($fp, LOCK_EX);
        fputs($fp, $message);
        fclose($fp);
        return TRUE;
    }
    function strip_comment($address) {
        $comment = "/\([^()]*\)/";
        while (preg_match($comment, $address)) {
            $address = preg_replace($comment, "", $address);
        }
        return $address;
    }
    function get_address($address) {
        $address = preg_replace("/([ \t\r\n])+/", "", $address);
        $address = preg_replace("/^.*&lt;(.+)&gt;.*$/", "\1", $address);
        return $address;
    }
    function smtp_debug($message) {
        if ($this-&gt;debug) {
            echo $message;
        }
    }
}
?&gt;         </textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-562afcc56785c712848215-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-2">2</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-4">4</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-6">6</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-8">8</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-10">10</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-12">12</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-14">14</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-16">16</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-18">18</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-20">20</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-22">22</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-24">24</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-26">26</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-28">28</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-30">30</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-32">32</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-34">34</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-36">36</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-38">38</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-40">40</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-42">42</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-44">44</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-46">46</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-48">48</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-50">50</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-52">52</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-54">54</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-56">56</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-58">58</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-60">60</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-62">62</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-64">64</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-66">66</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-68">68</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-70">70</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-72">72</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-74">74</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-76">76</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-78">78</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-80">80</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-82">82</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-84">84</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-86">86</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-88">88</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-90">90</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-92">92</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-94">94</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-96">96</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-98">98</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-100">100</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-102">102</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-104">104</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-106">106</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-108">108</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-110">110</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-112">112</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-114">114</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-116">116</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-118">118</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-120">120</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-122">122</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-124">124</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-126">126</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-128">128</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-130">130</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-132">132</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-134">134</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-136">136</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-138">138</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-140">140</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-142">142</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-144">144</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-146">146</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-148">148</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-150">150</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-152">152</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-154">154</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-156">156</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-158">158</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-160">160</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-162">162</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-164">164</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-166">166</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-168">168</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-170">170</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-172">172</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-174">174</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-176">176</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-178">178</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-179">179</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-180">180</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-181">181</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-182">182</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-183">183</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-184">184</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-185">185</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-186">186</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-188">188</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-190">190</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-192">192</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-194">194</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-196">196</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-198">198</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-199">199</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-200">200</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-201">201</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-202">202</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-203">203</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-204">204</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-205">205</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-206">206</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-207">207</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-208">208</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-209">209</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-210">210</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-211">211</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-212">212</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-213">213</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-214">214</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-215">215</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56785c712848215-216">216</div><div class="crayon-num" data-line="crayon-562afcc56785c712848215-217">217</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-562afcc56785c712848215-1"><span class="crayon-ta">&lt;?php</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-2">&nbsp;</div><div class="crayon-line" id="crayon-562afcc56785c712848215-3"><span class="crayon-c">/* smtp class */</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-4"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">smtp</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">/* Public Variables */</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">$smtp_port</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">$time_out</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">$host_name</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">$log_file</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">$relay_host</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">$debug</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">$auth</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">$user</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">$pass</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">/* Private Variables */</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-v">$sock</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">/* Constractor */</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">smtp</span><span class="crayon-sy">(</span><span class="crayon-v">$relay_host</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$smtp_port</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$auth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$user</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$pass</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">debug</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">FALSE</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">smtp_port</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$smtp_port</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">relay_host</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$relay_host</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">time_out</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//is used in fsockopen()</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">auth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$auth</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//auth</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">user</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$user</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">pass</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$pass</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">host_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"localhost"</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//is used in HELO command</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">log_file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">sock</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">FALSE</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">/* Main Function */</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">sendmail</span><span class="crayon-sy">(</span><span class="crayon-v">$to</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$from</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$subject</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$body</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$mailtype</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$cc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$bcc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$additional_headers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$mail_from</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_address</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">strip_comment</span><span class="crayon-sy">(</span><span class="crayon-v">$from</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$body</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">preg_replace</span><span class="crayon-sy">(</span><span class="crayon-s">"/(^|(\r\n))(\.)/"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"\1.\3"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$body</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$header</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"MIME-Version:1.0\r\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$mailtype</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"HTML"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$header</span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Content-Type:text/html\r\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$header</span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"To: "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$to</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\r\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$cc</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$header</span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Cc: "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$cc</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\r\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$header</span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"From: $from&lt;"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$from</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"&gt;\r\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$header</span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Subject: "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$subject</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\r\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$header</span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$additional_headers</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$header</span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Date: "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">date</span><span class="crayon-sy">(</span><span class="crayon-s">"r"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\r\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$header</span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"X-Mailer:By Redhat (PHP/"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">phpversion</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">")\r\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-v">$msec</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$sec</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">explode</span><span class="crayon-sy">(</span><span class="crayon-s">" "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">microtime</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$header</span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Message-ID: &lt;"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">date</span><span class="crayon-sy">(</span><span class="crayon-s">"YmdHis"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$sec</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"."</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$msec</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">1000000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"."</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$mail_from</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"&gt;\r\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$TO</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">explode</span><span class="crayon-sy">(</span><span class="crayon-s">","</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">strip_comment</span><span class="crayon-sy">(</span><span class="crayon-v">$to</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$cc</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$TO</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">array_merge</span><span class="crayon-sy">(</span><span class="crayon-v">$TO</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">explode</span><span class="crayon-sy">(</span><span class="crayon-s">","</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">strip_comment</span><span class="crayon-sy">(</span><span class="crayon-v">$cc</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$bcc</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$TO</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">array_merge</span><span class="crayon-sy">(</span><span class="crayon-v">$TO</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">explode</span><span class="crayon-sy">(</span><span class="crayon-s">","</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">strip_comment</span><span class="crayon-sy">(</span><span class="crayon-v">$bcc</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$sent</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">foreach</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$TO</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">$rcpt_to</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$rcpt_to</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">get_address</span><span class="crayon-sy">(</span><span class="crayon-v">$rcpt_to</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_sockopen</span><span class="crayon-sy">(</span><span class="crayon-v">$rcpt_to</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Error: Cannot send email to "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$rcpt_to</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$sent</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">FALSE</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">continue</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_send</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">host_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$mail_from</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$rcpt_to</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$header</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$body</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"E-mail has been sent to &lt;"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$rcpt_to</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"&gt;\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Error: Cannot send email to &lt;"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$rcpt_to</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"&gt;\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$sent</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">FALSE</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-71"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">fclose</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">sock</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Disconnected from remote host\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$sent</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">/* Private Functions */</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">smtp_send</span><span class="crayon-sy">(</span><span class="crayon-v">$helo</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$from</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$to</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$header</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$body</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_putcmd</span><span class="crayon-sy">(</span><span class="crayon-s">"HELO"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$helo</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-80"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_error</span><span class="crayon-sy">(</span><span class="crayon-s">"sending HELO command"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-81"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//auth</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">auth</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-84"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_putcmd</span><span class="crayon-sy">(</span><span class="crayon-s">"AUTH LOGIN"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">base64_encode</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">user</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_error</span><span class="crayon-sy">(</span><span class="crayon-s">"sending HELO command"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-86"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-87"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_putcmd</span><span class="crayon-sy">(</span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">base64_encode</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">pass</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-88"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_error</span><span class="crayon-sy">(</span><span class="crayon-s">"sending HELO command"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-89"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-90"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-91"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-92"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_putcmd</span><span class="crayon-sy">(</span><span class="crayon-s">"MAIL"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"FROM:&lt;"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$from</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"&gt;"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-93"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_error</span><span class="crayon-sy">(</span><span class="crayon-s">"sending MAIL FROM command"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-94"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-95"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_putcmd</span><span class="crayon-sy">(</span><span class="crayon-s">"RCPT"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"TO:&lt;"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$to</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"&gt;"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-96"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_error</span><span class="crayon-sy">(</span><span class="crayon-s">"sending RCPT TO command"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-97"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-98"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_putcmd</span><span class="crayon-sy">(</span><span class="crayon-s">"DATA"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-99"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_error</span><span class="crayon-sy">(</span><span class="crayon-s">"sending DATA command"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-100"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-101"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_message</span><span class="crayon-sy">(</span><span class="crayon-v">$header</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$body</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-102"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_error</span><span class="crayon-sy">(</span><span class="crayon-s">"sending message"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-103"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-104"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_eom</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-105"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_error</span><span class="crayon-sy">(</span><span class="crayon-s">"sending &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt; [EOM]"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-106"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-107"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_putcmd</span><span class="crayon-sy">(</span><span class="crayon-s">"QUIT"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-108"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_error</span><span class="crayon-sy">(</span><span class="crayon-s">"sending QUIT command"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-109"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-110"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-111"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-112"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">smtp_sockopen</span><span class="crayon-sy">(</span><span class="crayon-v">$address</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-113"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">relay_host</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-114"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_sockopen_mx</span><span class="crayon-sy">(</span><span class="crayon-v">$address</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-115"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-116"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_sockopen_relay</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-117"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-118"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-119"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">smtp_sockopen_relay</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-120"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Trying to "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">relay_host</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">":"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">smtp_port</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-121"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">sock</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-e">fsockopen</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">relay_host</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">smtp_port</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$errno</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$errstr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">time_out</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-122"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">sock</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_ok</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-123"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Error: Cannot connenct to relay host "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">relay_host</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-124"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Error: "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$errstr</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">" ("</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$errno</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">")\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-125"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">FALSE</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-126"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-127"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Connected to relay host "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">relay_host</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-128"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-129"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-130"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">smtp_sockopen_mx</span><span class="crayon-sy">(</span><span class="crayon-v">$address</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-131"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$domain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">preg_replace</span><span class="crayon-sy">(</span><span class="crayon-s">"/^.+@([^@]+)$/"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"\1"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$address</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-132"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">@</span><span class="crayon-e">getmxrr</span><span class="crayon-sy">(</span><span class="crayon-v">$domain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$MXHOSTS</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-133"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Error: Cannot resolve MX \""</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$domain</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-134"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">FALSE</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-135"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-136"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">foreach</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$MXHOSTS</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">$host</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-137"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Trying to "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$host</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">":"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">smtp_port</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-138"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">sock</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-e">fsockopen</span><span class="crayon-sy">(</span><span class="crayon-v">$host</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">smtp_port</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$errno</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$errstr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">time_out</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-139"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">sock</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_ok</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-140"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Warning: Cannot connect to mx host "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$host</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-141"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Error: "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$errstr</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">" ("</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$errno</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">")\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-142"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">continue</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-143"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-144"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Connected to mx host "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$host</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-145"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-146"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-147"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Error: Cannot connect to any mx hosts ("</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">implode</span><span class="crayon-sy">(</span><span class="crayon-s">", "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$MXHOSTS</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">")\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-148"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">FALSE</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-149"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-150"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">smtp_message</span><span class="crayon-sy">(</span><span class="crayon-v">$header</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$body</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-151"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">fputs</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">sock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$header</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\r\n"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$body</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-152"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_debug</span><span class="crayon-sy">(</span><span class="crayon-s">"&gt; "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">str_replace</span><span class="crayon-sy">(</span><span class="crayon-s">"\r\n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"\n"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"&gt; "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$header</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\n&gt; "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$body</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\n&gt; "</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-153"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-154"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-155"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">smtp_eom</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-156"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">fputs</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">sock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"\r\n.\r\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-157"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_debug</span><span class="crayon-sy">(</span><span class="crayon-s">". [EOM]\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-158"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_ok</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-159"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-160"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">smtp_ok</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-161"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$response</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str_replace</span><span class="crayon-sy">(</span><span class="crayon-s">"\r\n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">fgets</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">sock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">512</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-162"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_debug</span><span class="crayon-sy">(</span><span class="crayon-v">$response</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-163"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">preg_match</span><span class="crayon-sy">(</span><span class="crayon-s">"/^[23]/"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$response</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-164"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">fputs</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">sock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"QUIT\r\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-165"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">fgets</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">sock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">512</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-166"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Error: Remote host returned \""</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$response</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-167"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">FALSE</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-168"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-169"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-170"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-171"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">smtp_putcmd</span><span class="crayon-sy">(</span><span class="crayon-v">$cmd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$arg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-172"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$arg</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-173"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$cmd</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">$cmd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$arg</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-174"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">$cmd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$cmd</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">" "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$arg</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-175"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-176"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">fputs</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">sock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$cmd</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\r\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-177"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_debug</span><span class="crayon-sy">(</span><span class="crayon-s">"&gt; "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$cmd</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-178"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_ok</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-179"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-180"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">smtp_error</span><span class="crayon-sy">(</span><span class="crayon-v">$string</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-181"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-s">"Error: Error occurred while "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$string</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">".\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-182"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">FALSE</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-183"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-184"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">log_write</span><span class="crayon-sy">(</span><span class="crayon-v">$message</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-185"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_debug</span><span class="crayon-sy">(</span><span class="crayon-v">$message</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-186"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">log_file</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-187"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-188"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-189"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$message</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">date</span><span class="crayon-sy">(</span><span class="crayon-s">"M d H:i:s "</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">get_current_user</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"["</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">getmypid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"]: "</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$message</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-190"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">@</span><span class="crayon-e">file_exists</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">log_file</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">$fp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-e">fopen</span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">log_file</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"a"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-191"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">smtp_debug</span><span class="crayon-sy">(</span><span class="crayon-s">"Warning: Cannot open log file \""</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">log_file</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"\"\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-192"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">FALSE</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-193"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-194"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">flock</span><span class="crayon-sy">(</span><span class="crayon-v">$fp</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e ">LOCK_EX</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-195"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">fputs</span><span class="crayon-sy">(</span><span class="crayon-v">$fp</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$message</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-196"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">fclose</span><span class="crayon-sy">(</span><span class="crayon-v">$fp</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-197"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-198"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-199"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">strip_comment</span><span class="crayon-sy">(</span><span class="crayon-v">$address</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-200"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$comment</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"/\([^()]*\)/"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-201"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">preg_match</span><span class="crayon-sy">(</span><span class="crayon-v">$comment</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$address</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-202"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$address</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">preg_replace</span><span class="crayon-sy">(</span><span class="crayon-v">$comment</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$address</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-203"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-204"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$address</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-205"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-206"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">get_address</span><span class="crayon-sy">(</span><span class="crayon-v">$address</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-207"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$address</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">preg_replace</span><span class="crayon-sy">(</span><span class="crayon-s">"/([ \t\r\n])+/"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$address</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-208"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$address</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">preg_replace</span><span class="crayon-sy">(</span><span class="crayon-s">"/^.*&lt;(.+)&gt;.*$/"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"\1"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$address</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-209"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$address</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-210"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-211"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">smtp_debug</span><span class="crayon-sy">(</span><span class="crayon-v">$message</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-212"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">$this</span><span class="crayon-o">-&gt;</span><span class="crayon-i">debug</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-213"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-v">$message</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-214"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-215"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56785c712848215-216"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-562afcc56785c712848215-217"><span class="crayon-ta">?&gt;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0797 seconds] -->
<p>然后便是一个php文件引用该文件，设置好各种参数</p><!-- Crayon Syntax Highlighter v2.7.1 -->

		<div id="crayon-562afcc56786b263738218" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; float: left; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="含多种语言"></span><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">PHP</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;!DOCTYPE&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
		&lt;title&gt;发送状态&lt;/title&gt;
	&lt;/head&gt;
	&lt;body&gt;
		&lt;?php

			require_once "email.class.php";
			//SMTP服务器
			$smtpserver = "smtp.163.com";
			//SMTP端口号?
			$smtpserverport = 25;
			//SMTP发邮件的邮箱
			$smtpusermail = "cqc@163.com";
			//发给谁
			$smtpemailto = $_POST['toemail'];
			//SMTP用户名，不加@163.com
			$smtpuser = "cqc";
			//SMTP用户密码
			$smtppass = "wtf";
			//主题
			$mailtitle = $_POST['topic'];
			//构建内容
			$mailcontent = "TA的名字 ".$_POST['name']."&lt;br&gt;内容: ".$_POST['content'];
			//邮件内容为HTML格式
			$mailtype = "HTML";
			//实例化对象
			$smtp = new smtp($smtpserver,$smtpserverport,true,$smtpuser,$smtppass);
			//关闭调试信息
			$smtp-&gt;debug = false;
			//发送邮件
			$state = $smtp-&gt;sendmail($smtpemailto, $smtpusermail, $mailtitle, $mailcontent, $mailtype);
			//检查发送状态
			if($state==""){
				echo "邮件发送失败，请检查密码或其他设置";
			}else if(strlen($state)!=0){
			//发送成功
				echo "邮件发送成功";
			}else{
				echo "未知错误";
			}

		?&gt;
	&lt;/body&gt;
&lt;/html&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-562afcc56786b263738218-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-2">2</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-4">4</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-6">6</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-8">8</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-10">10</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-12">12</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-14">14</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-16">16</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-18">18</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-20">20</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-22">22</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-24">24</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-26">26</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-28">28</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-30">30</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-32">32</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-34">34</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-36">36</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-38">38</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-40">40</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-42">42</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-44">44</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc56786b263738218-46">46</div><div class="crayon-num" data-line="crayon-562afcc56786b263738218-47">47</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-562afcc56786b263738218-1"><span class="crayon-o">&lt;</span><span class="crayon-o">!</span><span class="crayon-cn">DOCTYPE</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-2"><span class="crayon-o">&lt;</span><span class="crayon-i">html</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-i">head</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">meta </span><span class="crayon-i">http</span><span class="crayon-o">-</span><span class="crayon-i">equiv</span><span class="crayon-o">=</span><span class="crayon-s">"Content-Type"</span><span class="crayon-h"> </span><span class="crayon-i">content</span><span class="crayon-o">=</span><span class="crayon-s">"text/html; charset=utf-8"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">title</span><span class="crayon-o">&gt;</span>发送状态<span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-e">title</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-e">head</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-ta">&lt;?php</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">require_once</span><span class="crayon-h"> </span><span class="crayon-s">"email.class.php"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//SMTP服务器</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$smtpserver</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"smtp.163.com"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//SMTP端口号?</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$smtpserverport</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//SMTP发邮件的邮箱</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$smtpusermail</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"cqc@163.com"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//发给谁</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$smtpemailto</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'toemail'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//SMTP用户名，不加@163.com</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$smtpuser</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"cqc"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//SMTP用户密码</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$smtppass</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"wtf"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//主题</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$mailtitle</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'topic'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//构建内容</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$mailcontent</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"TA的名字 "</span><span class="crayon-sy">.</span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'name'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-s">"&lt;br&gt;内容: "</span><span class="crayon-sy">.</span><span class="crayon-v">$_POST</span><span class="crayon-sy">[</span><span class="crayon-s">'content'</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//邮件内容为HTML格式</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$mailtype</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"HTML"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//实例化对象</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$smtp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">smtp</span><span class="crayon-sy">(</span><span class="crayon-v">$smtpserver</span><span class="crayon-sy">,</span><span class="crayon-v">$smtpserverport</span><span class="crayon-sy">,</span><span class="crayon-t">true</span><span class="crayon-sy">,</span><span class="crayon-v">$smtpuser</span><span class="crayon-sy">,</span><span class="crayon-v">$smtppass</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//关闭调试信息</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$smtp</span><span class="crayon-o">-&gt;</span><span class="crayon-i">debug</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//发送邮件</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$smtp</span><span class="crayon-o">-&gt;</span><span class="crayon-e">sendmail</span><span class="crayon-sy">(</span><span class="crayon-v">$smtpemailto</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$smtpusermail</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$mailtitle</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$mailcontent</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$mailtype</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//检查发送状态</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">$state</span><span class="crayon-o">==</span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-s">"邮件发送失败，请检查密码或其他设置"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-e">strlen</span><span class="crayon-sy">(</span><span class="crayon-v">$state</span><span class="crayon-sy">)</span><span class="crayon-o">!=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//发送成功</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-s">"邮件发送成功"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-st">else</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-s">"未知错误"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-44">&nbsp;</div><div class="crayon-line" id="crayon-562afcc56786b263738218-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-ta">?&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc56786b263738218-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-562afcc56786b263738218-47"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-i">html</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0098 seconds] -->
<p>最后是一个表单提交，包括目的邮箱，主题，内容</p><!-- Crayon Syntax Highlighter v2.7.1 -->

		<div id="crayon-562afcc567873000352209" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; float: left; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;!DOCTYPE&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
		&lt;title&gt;PHP利用SMTP发送邮件范例&lt;/title&gt;
	&lt;/head&gt;
	&lt;body&gt;
		&lt;form action="sendmail.php" method="post"&gt;
			&lt;p&gt;收件人：&lt;input type="text" name="toemail" /&gt;&lt;/p&gt;
			&lt;p&gt;标&amp;nbsp;&amp;nbsp;题：&lt;input type="text" name="topic" /&gt;&lt;/p&gt;
			&lt;p&gt;姓&amp;nbsp;&amp;nbsp;名：&lt;input type="text" name="name" /&gt;&lt;/p&gt;
			&lt;p&gt;内&amp;nbsp;&amp;nbsp;容：&lt;textarea name="content" cols="50" rows="5"&gt;&lt;/textarea&gt;&lt;/p&gt;
			&lt;p&gt;&lt;input type="submit" value="发送"  /&gt;&lt;/p&gt;
		&lt;/form&gt;
	&lt;/body&gt;
&lt;/html&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-562afcc567873000352209-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc567873000352209-2">2</div><div class="crayon-num" data-line="crayon-562afcc567873000352209-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc567873000352209-4">4</div><div class="crayon-num" data-line="crayon-562afcc567873000352209-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc567873000352209-6">6</div><div class="crayon-num" data-line="crayon-562afcc567873000352209-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc567873000352209-8">8</div><div class="crayon-num" data-line="crayon-562afcc567873000352209-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc567873000352209-10">10</div><div class="crayon-num" data-line="crayon-562afcc567873000352209-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc567873000352209-12">12</div><div class="crayon-num" data-line="crayon-562afcc567873000352209-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc567873000352209-14">14</div><div class="crayon-num" data-line="crayon-562afcc567873000352209-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-562afcc567873000352209-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-562afcc567873000352209-1"><span class="crayon-o">&lt;</span><span class="crayon-o">!</span><span class="crayon-v">DOCTYPE</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc567873000352209-2"><span class="crayon-o">&lt;</span><span class="crayon-v">html</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-562afcc567873000352209-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">head</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc567873000352209-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">meta </span><span class="crayon-v">http</span><span class="crayon-o">-</span><span class="crayon-v">equiv</span><span class="crayon-o">=</span><span class="crayon-s">"Content-Type"</span><span class="crayon-h"> </span><span class="crayon-v">content</span><span class="crayon-o">=</span><span class="crayon-s">"text/html; charset=utf-8"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-562afcc567873000352209-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">title</span><span class="crayon-o">&gt;</span><span class="crayon-i">PHP</span>利用<span class="crayon-i">SMTP</span>发送邮件范例<span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">title</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc567873000352209-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">head</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-562afcc567873000352209-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc567873000352209-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-e">form </span><span class="crayon-v">action</span><span class="crayon-o">=</span><span class="crayon-s">"sendmail.php"</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"post"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-562afcc567873000352209-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span>收件人：<span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"text"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"toemail"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc567873000352209-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span>标<span class="crayon-o">&amp;</span><span class="crayon-v">nbsp</span><span class="crayon-sy">;</span><span class="crayon-o">&amp;</span><span class="crayon-v">nbsp</span><span class="crayon-sy">;</span>题：<span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"text"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"topic"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-562afcc567873000352209-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span>姓<span class="crayon-o">&amp;</span><span class="crayon-v">nbsp</span><span class="crayon-sy">;</span><span class="crayon-o">&amp;</span><span class="crayon-v">nbsp</span><span class="crayon-sy">;</span>名：<span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"text"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"name"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc567873000352209-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span>内<span class="crayon-o">&amp;</span><span class="crayon-v">nbsp</span><span class="crayon-sy">;</span><span class="crayon-o">&amp;</span><span class="crayon-v">nbsp</span><span class="crayon-sy">;</span>容：<span class="crayon-o">&lt;</span><span class="crayon-e">textarea </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"content"</span><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-o">=</span><span class="crayon-s">"50"</span><span class="crayon-h"> </span><span class="crayon-v">rows</span><span class="crayon-o">=</span><span class="crayon-s">"5"</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">textarea</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-562afcc567873000352209-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-e">input </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"submit"</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">=</span><span class="crayon-s">"发送"</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">p</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc567873000352209-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">form</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-562afcc567873000352209-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">body</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-562afcc567873000352209-16"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">html</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0056 seconds] -->
<p></p>
<h2> 代码下载</h2>
<p><a class="dl link" title="" href="https://github.com/cqcre/sendmail" target="_blank" data-original-title="">代码下载</a></p>
<p>转载请注明：<a href="http://cuiqingcai.com">静觅</a> &raquo; <a href="http://cuiqingcai.com/1470.html">PHP高级特性四之SMTP邮件发送</a></p>

      
<div class="article-social">
			<a href="javascript:;" data-action="ding" data-id="1470" id="Addlike" class="action"><i class="fa fa-heart-o"></i>喜欢 (<span class="count">2</span>)</a><span class="or">or</span><span class="action action-share bdsharebuttonbox"><i class="fa fa-share-alt"></i>分享 (<span class="bds_count" data-cmd="count" title="累计分享0次">0</span>)<div class="action-popover"><div class="popover top in"><div class="arrow"></div><div class="popover-content"><a href="#" class="sinaweibo fa fa-weibo" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_qzone fa fa-star" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="tencentweibo fa fa-tencent-weibo" data-cmd="tqq" title="分享到腾讯微博"></a><a href="#" class="qq fa fa-qq" data-cmd="sqq" title="分享到QQ好友"></a><a href="#" class="bds_renren fa fa-renren" data-cmd="renren" title="分享到人人网"></a><a href="#" class="bds_weixin fa fa-weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_more fa fa-ellipsis-h" data-cmd="more"></a></div></div></div></span>	
</div>
	</article>	
				<div style="background:#fff;padding-bottom:20px;font-size:14px;">
			<p style="text-align: center;margin-bottom:20px;padding:0px 20px">您的支持是博主写作最大的动力，如果您喜欢我的文章，感觉我的文章对您有帮助，请狠狠点击下面的</p>
			<p style="text-align: center;"><a href="http://cuiqingcai.com/donate"> <input style="width: 310px; margin: 10px auto 0px; background-color: #f58a87; color: #ffffff; height: 40px; border: none; font-family: 'Microsoft Yahei'; font-size: 16px; letter-spacing: 2px;" type="button" value="我要小额赞助" /></a>
		</div>
		<footer class="article-footer">
			<div class="article-tags"><i class="fa fa-tags"></i><a href="http://cuiqingcai.com/tag/php" rel="tag">PHP</a></div>		</footer>
	<nav class="article-nav">
			<span class="article-nav-prev"><i class="fa fa-angle-double-left"></i> <a href="http://cuiqingcai.com/1444.html" rel="prev">JavaScript高级用法五之常用对象</a></span>
			<span class="article-nav-next"><a href="http://cuiqingcai.com/1473.html" rel="next">PHP高级特性五之时间处理</a>  <i class="fa fa-angle-double-right"></i></span>
		</nav>

		<div class="related_top">
			<div class="related_posts"><ul class="related_img">

		<li class="related_box"  >
		<a href="http://cuiqingcai.com/2076.html" title="浅谈CSRF攻击方式" target="_blank">
<img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/09/wallpaper_5229823.jpg&h=110&w=185&q=90&zc=1&ct=1" alt="浅谈CSRF攻击方式" />	<br><span class="r_title">浅谈CSRF攻击方式</span></a>
		</li>
	
		<li class="related_box"  >
		<a href="http://cuiqingcai.com/2036.html" title="Ubuntu Linux配置Nginx+MySQL+PHP+phpMyAdmin详细步骤" target="_blank">
<img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/09/wallpaper_5264972.jpg&h=110&w=185&q=90&zc=1&ct=1" alt="Ubuntu Linux配置Nginx+MySQL+PHP+phpMyAdmin详细步骤" />	<br><span class="r_title">Ubuntu Linux配置Nginx+MySQL+PHP+phpMyAdmin详细步骤</span></a>
		</li>
	
		<li class="related_box"  >
		<a href="http://cuiqingcai.com/1853.html" title="将普通文本替换为正常HTML文本的方法" target="_blank">
<img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/06/wallpaper_5267322.jpg&h=110&w=185&q=90&zc=1&ct=1" alt="将普通文本替换为正常HTML文本的方法" />	<br><span class="r_title">将普通文本替换为正常HTML文本的方法</span></a>
		</li>
	
		<li class="related_box"  >
		<a href="http://cuiqingcai.com/1534.html" title="PHP高级特性八之mysqli函数库的使用" target="_blank">
<img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/03/wallpaper_5255580.jpg&h=110&w=185&q=90&zc=1&ct=1" alt="PHP高级特性八之mysqli函数库的使用" />	<br><span class="r_title">PHP高级特性八之mysqli函数库的使用</span></a>
		</li>
	</ul>

<div class="relates">
<ul>
<li><i class="fa fa-minus"></i><a href="http://cuiqingcai.com/2076.html">浅谈CSRF攻击方式</a></li><li><i class="fa fa-minus"></i><a href="http://cuiqingcai.com/2036.html">Ubuntu Linux配置Nginx+MySQL+PHP+phpMyAdmin详细步骤</a></li><li><i class="fa fa-minus"></i><a href="http://cuiqingcai.com/1853.html">将普通文本替换为正常HTML文本的方法</a></li><li><i class="fa fa-minus"></i><a href="http://cuiqingcai.com/1534.html">PHP高级特性八之mysqli函数库的使用</a></li><li><i class="fa fa-minus"></i><a href="http://cuiqingcai.com/1527.html">PHP高级特性七之验证码操作</a></li><li><i class="fa fa-minus"></i><a href="http://cuiqingcai.com/1515.html">PHP高级特性六之图像处理</a></li><li><i class="fa fa-minus"></i><a href="http://cuiqingcai.com/1479.html">PHP高级特性学习总结</a></li><li><i class="fa fa-minus"></i><a href="http://cuiqingcai.com/1473.html">PHP高级特性五之时间处理</a></li>
</ul></div></div>		</div>
						<a name="comments"></a>

<div class="ds-thread" data-thread-key="1470" data-author-key="1" data-title="PHP高级特性四之SMTP邮件发送" data-url="http://cuiqingcai.com/1470.html"></div>

<script type="text/javascript">
	if (typeof DUOSHUO !== 'undefined')
		DUOSHUO.EmbedThread('.ds-thread');
</script>
	<div id="ds-ssr">

		
            <ol id="commentlist">
                		<li class="comment even thread-even depth-1" id="li-comment-388">
			<article id="comment-388" class="comment">
				<footer class="comment-meta">
					<cite class="comment-author vcard">
						<span class="fn">hao-app</span> on <a rel="nofollow" href="http://cuiqingcai.com/1470.html/comment-page-1#comment-388"><time pubdate datetime="2015-05-13T18:54:01+00:00">2015年5月13日 at 下午6:54</time></a> <span class="says">said:</span>					</cite><!-- .comment-author .vcard -->
				</footer>
	
				<div class="comment-content"><p>请问在本地Apache服务器试用可以吗？我这样做，发送失败，显示第email.class.php 47行错误</p>
</div>
				
			</article><!-- #comment-## -->
		<ul class="children">
		<li class="comment byuser comment-author-cqcre bypostauthor odd alt depth-2" id="li-comment-389">
			<article id="comment-389" class="comment">
				<footer class="comment-meta">
					<cite class="comment-author vcard">
						<span class="fn"><a href='http://cuiqingcai.com/' rel='external nofollow' class='url'>崔庆才</a></span> on <a rel="nofollow" href="http://cuiqingcai.com/1470.html/comment-page-1#comment-389"><time pubdate datetime="2015-05-13T19:09:31+00:00">2015年5月13日 at 下午7:09</time></a> <span class="says">said:</span>					</cite><!-- .comment-author .vcard -->
				</footer>
	
				<div class="comment-content"><p>可以的，我就是用的apache，47行是date函数，是不是你没有设置时区的缘故？</p>
</div>
				
			</article><!-- #comment-## -->
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
            </ol>

		            
    </div>			</div>
</div>
<aside class="sidebar">	
<div class="widget widget_text"><div class="textwidget"><div class="social">

<a href="http://weibo.com/u/2830678474" rel="external nofollow" title="新浪微博" target="_blank"><i class="sinaweibo fa fa-weibo"></i></a><a  href="http://t.qq.com/CQCcqc123456?preview" rel="external nofollow" title="腾讯微博" target="_blank"><i class="tencentweibo fa fa-tencent-weibo"></i></a><a class="weixin"><i class="weixins fa fa-weixin"></i><div class="weixin-popover"><div class="popover bottom in"><div class="arrow"></div><div class="popover-title"></div><div class="popover-content"><img src="http://cuiqingcai.com/wp-content/themes/Yusi/img/weixin.gif" ></div></div></div></a>
<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=1016903103@qq.com" rel="external nofollow" title="Email" target="_blank"><i class="email fa fa-envelope-o"></i></a><a href="http://user.qzone.qq.com/1016903103/" rel="external nofollow" title="联系QQ" target="_blank"><i class="qq fa fa-qq"></i></a><a href="?feed=rss2" rel="external nofollow" target="_blank"  title="订阅本站"><i class="rss fa fa-rss"></i></a>
</div></div></div>

<div class="widget widget_archive"><div class="title"><h2>文章归档</h2></div>		<ul>
	<li><a href='http://cuiqingcai.com/date/2015/10'>2015年十月</a></li>
	<li><a href='http://cuiqingcai.com/date/2015/09'>2015年九月</a></li>
	<li><a href='http://cuiqingcai.com/date/2015/08'>2015年八月</a></li>
	<li><a href='http://cuiqingcai.com/date/2015/07'>2015年七月</a></li>
	<li><a href='http://cuiqingcai.com/date/2015/06'>2015年六月</a></li>
	<li><a href='http://cuiqingcai.com/date/2015/05'>2015年五月</a></li>
	<li><a href='http://cuiqingcai.com/date/2015/04'>2015年四月</a></li>
	<li><a href='http://cuiqingcai.com/date/2015/03'>2015年三月</a></li>
	<li><a href='http://cuiqingcai.com/date/2015/02'>2015年二月</a></li>
	<li><a href='http://cuiqingcai.com/date/2015/01'>2015年一月</a></li>
	<li><a href='http://cuiqingcai.com/date/2014/12'>2014年十二月</a></li>
	<li><a href='http://cuiqingcai.com/date/2014/11'>2014年十一月</a></li>
	<li><a href='http://cuiqingcai.com/date/2014/10'>2014年十月</a></li>
	<li><a href='http://cuiqingcai.com/date/2014/09'>2014年九月</a></li>
		</ul>
</div><div class="widget widget_text"><div class="title"><h2>原创游戏</h2></div>			<div class="textwidget"><div class="taobaotextad">
<p style="
    margin-left: 20px;
    color: #00a67c;
">BallEscape丨博主开发的一款休闲益智虐心游戏 </p><p style="
    margin-left: 10px;
">
<a href="http://res.cuiqingcai.com/ballescape/">
<input type="button" value="了解更多" style="width: 310px; margin: 10px auto 0px; background-color: rgb(245, 138, 135); color: rgb(255, 255, 255); height: 40px; border: none; font-family: 'Microsoft Yahei'; font-size: 16px; letter-spacing: 2px;" onmouseover="this.style.backgroundColor='rgb(252, 125, 121)'" onmouseout="this.style.backgroundColor='#F58A87'"></a>
</p></div></div>
		</div><div class="widget d_postlist"><div class="title"><h2>猜你喜欢</h2></div><ul><li><a href="http://cuiqingcai.com/990.html" title="Python爬虫实战一之爬取糗事百科段子" ><span class="thumbnail"><img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/02/wallpaper_5228661.jpg&h=64&w=100&q=90&zc=1&ct=1" alt="Python爬虫实战一之爬取糗事百科段子" /></span><span class="text">Python爬虫实战一之爬取糗事百科段子</span><span class="muted">2015-02-17</span><span class="muted"><span class="ds-thread-count" data-thread-key="990" data-replace="1">114评论</span></span></a></li>
<li><a href="http://cuiqingcai.com/1001.html" title="Python爬虫实战四之抓取淘宝MM照片" ><span class="thumbnail"><img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/02/wallpaper_5270641.jpg&h=64&w=100&q=90&zc=1&ct=1" alt="Python爬虫实战四之抓取淘宝MM照片" /></span><span class="text">Python爬虫实战四之抓取淘宝MM照片</span><span class="muted">2015-02-20</span><span class="muted"><span class="ds-thread-count" data-thread-key="1001" data-replace="1">79评论</span></span></a></li>
<li><a href="http://cuiqingcai.com/1076.html" title="Python爬虫实战五之模拟登录淘宝并获取所有订单" ><span class="thumbnail"><img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/02/wallpaper_5226152.jpg&h=64&w=100&q=90&zc=1&ct=1" alt="Python爬虫实战五之模拟登录淘宝并获取所有订单" /></span><span class="text">Python爬虫实战五之模拟登录淘宝并获取所有订单</span><span class="muted">2015-02-24</span><span class="muted"><span class="ds-thread-count" data-thread-key="1076" data-replace="1">69评论</span></span></a></li>
<li><a href="http://cuiqingcai.com/993.html" title="Python爬虫实战二之爬取百度贴吧帖子" ><span class="thumbnail"><img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/02/wallpaper_5265936.jpg&h=64&w=100&q=90&zc=1&ct=1" alt="Python爬虫实战二之爬取百度贴吧帖子" /></span><span class="text">Python爬虫实战二之爬取百度贴吧帖子</span><span class="muted">2015-02-17</span><span class="muted"><span class="ds-thread-count" data-thread-key="993" data-replace="1">46评论</span></span></a></li>
<li><a href="http://cuiqingcai.com/1052.html" title="Python爬虫学习系列教程" ><span class="thumbnail"><img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/02/wallpaper_5254665-e1424499272248.jpg&h=64&w=100&q=90&zc=1&ct=1" alt="Python爬虫学习系列教程" /></span><span class="text">Python爬虫学习系列教程</span><span class="muted">2015-02-21</span><span class="muted"><span class="ds-thread-count" data-thread-key="1052" data-replace="1">43评论</span></span></a></li>
<li><a href="http://cuiqingcai.com/968.html" title="Python爬虫入门六之Cookie的使用" ><span class="thumbnail"><img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/02/wallpaper_5258536-1.jpg&h=64&w=100&q=90&zc=1&ct=1" alt="Python爬虫入门六之Cookie的使用" /></span><span class="text">Python爬虫入门六之Cookie的使用</span><span class="muted">2015-02-15</span><span class="muted"><span class="ds-thread-count" data-thread-key="968" data-replace="1">36评论</span></span></a></li>
<li><a href="http://cuiqingcai.com/997.html" title="Python爬虫实战三之计算大学本学期绩点" ><span class="thumbnail"><img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/02/wallpaper_5265978.jpg&h=64&w=100&q=90&zc=1&ct=1" alt="Python爬虫实战三之计算大学本学期绩点" /></span><span class="text">Python爬虫实战三之计算大学本学期绩点</span><span class="muted">2015-02-20</span><span class="muted"><span class="ds-thread-count" data-thread-key="997" data-replace="1">31评论</span></span></a></li>
<li><a href="http://cuiqingcai.com/912.html" title="Python爬虫进阶一之爬虫框架Scrapy安装配置" ><span class="thumbnail"><img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/02/d52a2834349b033b20721ee016ce36d3d539bd16.jpg&h=64&w=100&q=90&zc=1&ct=1" alt="Python爬虫进阶一之爬虫框架Scrapy安装配置" /></span><span class="text">Python爬虫进阶一之爬虫框架Scrapy安装配置</span><span class="muted">2015-02-17</span><span class="muted"><span class="ds-thread-count" data-thread-key="912" data-replace="1">29评论</span></span></a></li>
<li><a href="http://cuiqingcai.com/1319.html" title="Python爬虫入门八之Beautiful Soup的用法" ><span class="thumbnail"><img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/03/wallpaper_52546561.jpg&h=64&w=100&q=90&zc=1&ct=1" alt="Python爬虫入门八之Beautiful Soup的用法" /></span><span class="text">Python爬虫入门八之Beautiful Soup的用法</span><span class="muted">2015-03-11</span><span class="muted"><span class="ds-thread-count" data-thread-key="1319" data-replace="1">26评论</span></span></a></li>
<li><a href="http://cuiqingcai.com/947.html" title="Python爬虫入门三之Urllib库的基本使用" ><span class="thumbnail"><img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/02/wallpaper_5226849-1.jpg&h=64&w=100&q=90&zc=1&ct=1" alt="Python爬虫入门三之Urllib库的基本使用" /></span><span class="text">Python爬虫入门三之Urllib库的基本使用</span><span class="muted">2015-02-13</span><span class="muted"><span class="ds-thread-count" data-thread-key="947" data-replace="1">20评论</span></span></a></li>
</ul></div><div class="widget widget_text"><div class="title"><h2>我要投稿</h2></div>			<div class="textwidget"><div class="taobaotextad">
<p style="
    margin-left: 20px;
    color: #00a67c;
">想让自己的文章出现在这里吗?赶快注册投稿吧！</p><p style="
    margin-left: 10px;
">
<a href="http://cuiqingcai.com/wp-login.php?action=register">
<input type="button" value="点我投稿" style="width: 310px; margin: 10px auto 0px; background-color: rgb(245, 138, 135); color: rgb(255, 255, 255); height: 40px; border: none; font-family: 'Microsoft Yahei'; font-size: 16px; letter-spacing: 2px;" onmouseover="this.style.backgroundColor='rgb(252, 125, 121)'" onmouseout="this.style.backgroundColor='#F58A87'"></a>
</p></div></div>
		</div><div class="widget d_tag"><div class="title"><h2>标签云</h2></div><div class="d_tags"><a title="25个话题" href="http://cuiqingcai.com/tag/php">PHP (25)</a><a title="20个话题" href="http://cuiqingcai.com/tag/python">Python (20)</a><a title="16个话题" href="http://cuiqingcai.com/tag/%e7%88%ac%e8%99%ab">爬虫 (16)</a><a title="13个话题" href="http://cuiqingcai.com/tag/js">JS (13)</a><a title="10个话题" href="http://cuiqingcai.com/tag/opengl">OpenGL (10)</a><a title="8个话题" href="http://cuiqingcai.com/tag/html">HTML (8)</a><a title="6个话题" href="http://cuiqingcai.com/tag/linux">Linux (6)</a><a title="6个话题" href="http://cuiqingcai.com/tag/jquery">jQuery (6)</a><a title="6个话题" href="http://cuiqingcai.com/tag/winpcap">Winpcap (6)</a><a title="4个话题" href="http://cuiqingcai.com/tag/git">Git (4)</a><a title="4个话题" href="http://cuiqingcai.com/tag/wordpress">WordPress (4)</a><a title="4个话题" href="http://cuiqingcai.com/tag/security">Security (4)</a><a title="3个话题" href="http://cuiqingcai.com/tag/java">Java (3)</a><a title="3个话题" href="http://cuiqingcai.com/tag/mysql">Mysql (3)</a><a title="2个话题" href="http://cuiqingcai.com/tag/cocos2d-x">Cocos2d-x (2)</a><a title="2个话题" href="http://cuiqingcai.com/tag/jsp">JSP (2)</a><a title="2个话题" href="http://cuiqingcai.com/tag/matlab">Matlab (2)</a><a title="2个话题" href="http://cuiqingcai.com/tag/bootstrap">Bootstrap (2)</a><a title="2个话题" href="http://cuiqingcai.com/tag/photoshop">Photoshop (2)</a><a title="2个话题" href="http://cuiqingcai.com/tag/css">CSS (2)</a><a title="2个话题" href="http://cuiqingcai.com/tag/net">Net (2)</a><a title="1个话题" href="http://cuiqingcai.com/tag/json">Json (1)</a><a title="1个话题" href="http://cuiqingcai.com/tag/redis">Redis (1)</a><a title="1个话题" href="http://cuiqingcai.com/tag/less">LESS (1)</a><a title="1个话题" href="http://cuiqingcai.com/tag/nginx">Nginx (1)</a></div></div><div class="widget widget_links"><div class="title"><h2>友情链接</h2></div>
	<ul class='xoxo blogroll'>
<li><a href="http://www.anotherhome.net" target="_blank"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2015/03/wallpaper_5264963.jpg"  alt="Anotherhome "  /> Anotherhome</a></li>
<li><a href="http://zhouchenwen.com" rel="acquaintance" target="_blank"><img src="http://zhouchenwen-wordpress.stor.sinaapp.com/uploads/2015/03/beatiful.jpg"  alt="ColdCoder "  /> ColdCoder</a></li>
<li><a href="http://www.findspace.name" target="_blank"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2015/02/wallpaper_5254666.jpg"  alt="Findspace "  /> Findspace</a></li>
<li><a href="http://blog.hickwu.com/" target="_blank"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2015/04/wallpaper_5270857.jpg"  alt="Hick "  /> Hick</a></li>
<li><a href="http://www.nopcn.com" target="_blank"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2015/07/wallpaper_5263470.jpg"  alt="nopcommerce "  /> nopcommerce</a></li>
<li><a href="http://www.atrail.cn/" target="_blank"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2015/02/wallpaper_5254665-e1424499272248.jpg"  alt="从前以后 "  /> 从前以后</a></li>
<li><a href="http://www.superqq.com/"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2015/05/wallpaper_5265810.jpg"  alt="刚刚在线 "  /> 刚刚在线</a></li>
<li><a href="http://www.lvtao.net" target="_blank"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2015/02/wallpaper_5228675.jpg"  alt="吕滔博客 "  /> 吕滔博客</a></li>
<li><a href="http://www.fddcn.cn" target="_blank"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2015/04/wallpaper_5228669.jpg"  alt="奋斗的承诺 "  /> 奋斗的承诺</a></li>
<li><a href="http://www.zuilizhi.net/" target="_blank"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2015/07/wallpaper_5247812.jpg"  alt="最励志网 "  /> 最励志网</a></li>
<li><a href="http://www.lishengcn.cn/" target="_blank"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2015/02/wallpaper_5266007.jpg"  alt="李胜的脚步 "  /> 李胜的脚步</a></li>
<li><a href="http://liaoyuming.cn" rel="acquaintance" target="_blank"><img src="http://liaoyuming.cn/wp-content/uploads/2015/03/3-750x300.jpg"  alt="永远站 "  /> 永远站</a></li>
<li><a href="http://www.hubwiz.com" target="_blank"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2015/08/wallpaper_5269088.jpg"  alt="汇智网 "  /> 汇智网</a></li>
<li><a href="http://www.leyle.com/" target="_blank"><img src="http://cuiqingcai.com/wp-content/themes/Yusi/timthumb.php?src=http://qiniu.cuiqingcai.com/wp-content/uploads/2015/04/wallpaper_5259137-1.jpg&amp;h=123&amp;w=200&amp;q=90&amp;zc=1&amp;ct=1"  alt="遗落岛 "  /> 遗落岛</a></li>

	</ul>
</div>
<div class="widget widget_text"><div class="title"><h2>本站热门</h2></div>			<div class="textwidget"><div class = "taobaotextad" style="margin-top:-10px;"><script>document.write(unescape('%3Cdiv id="hm_t_59089"%3E%3C/div%3E%3Cscript charset="utf-8" src="http://crs.baidu.com/t.js?siteId=3ef185224776ec2561c9f7066ead4f24&planId=59089&async=0&referer=') + encodeURIComponent(document.referrer) + '&title=' + encodeURIComponent(document.title) + '&rnd=' + (+new Date) + unescape('"%3E%3C/script%3E'));</script>
</div></div>
		</div><div class="widget widget_text"><div class="title"><h2>休闲一下</h2></div>			<div class="textwidget"><div  style = "text-align: center" width="100%"><a href = "http://res.cuiqingcai.com/2048">
<img src = "http://cuiqingcai.com/wp-content/uploads/2014/11/2048.jpg" style="margin:10px 0 10px 0" alt = "2048游戏"/>
</a></div></div>
		</div><div class="widget widget_text"><div class="title"><h2>新浪微博</h2></div>			<div class="textwidget"><iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=0&noborder=0&isWeibo=1&isFans=1&uid=2830678474&verifier=7468dc7b&dpc=1"></iframe></div>
		</div><div class="widget widget_text"><div class="title"><h2>精品推荐</h2></div>			<div class="textwidget"><div class = "taobaotextad">
<script type="text/javascript">
var cpro_id="u1974136";
(window["cproStyleApi"] = window["cproStyleApi"] || {})[cpro_id]={at:"3",rsi0:"338",rsi1:"330",pat:"6",tn:"baiduCustNativeAD",rss1:"#FFFFFF",conBW:"0",adp:"1",ptt:"0",titFF:"%E5%BE%AE%E8%BD%AF%E9%9B%85%E9%BB%91",titFS:"",rss2:"#00a67c",titSU:"0",ptbg:"70",piw:"130",pih:"80",ptp:"0"}
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
</div></div>
		</div></aside></section>
<footer class="footer">
    <div class="footer-inner">
        <div class="copyright pull-left">
         <a href="http://cuiqingcai.com " title="静觅">静觅</a> 版权所有丨采用<a href="http://yusi123.com/"> 欲思 </a>主题丨基于<a href="http://cn.wordpress.org/" title="WordPress"> WordPress </a>构建   © 2015丨托管于 <a rel="nofollow" target="_blank" href="http://www.aliyun.com/">阿里云主机</a> & <a rel="nofollow" target="_blank" href="http://www.qiniu.com/">七牛云存储 </a>丨鲁ICP备14030596号
		 <div>
			<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1253486800'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/z_stat.php%3Fid%3D1253486800%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));</script>
		 </div>
		</div>
        
    </div>
</footer>

<script type='text/javascript'>
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"http:\/\/cuiqingcai.com\/wp-admin\/admin-ajax.php","post_id":"1470"};
/* ]]> */
</script>
<script type='text/javascript' src='http://cuiqingcai.com/wp-content/plugins/wp-postviews/postviews-cache.js?ver=1.68'></script>
<script type='text/javascript' src='http://cuiqingcai.com/wp-content/themes/Yusi/js/jquery.js?ver=1.0'></script>
<script>with(document)0[(getElementsByTagName("head")[0]||body).appendChild(createElement("script")).src="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion="+~(-new Date()/36e5)];</script><!-- xuanfu -->
 <script type="text/javascript">
    /*300*25 创建于 2015-02-23*/
    var cpro_id = "u1959047";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/s.js" type="text/javascript"></script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F3ef185224776ec2561c9f7066ead4f24' type='text/javascript'%3E%3C/script%3E"));
</script>

</body>
</html>
<!-- Dynamic page generated in 0.476 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2015-10-24 11:36:37 -->

<!-- super cache -->